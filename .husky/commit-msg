commit_msg_file="$1"
first_line="$(head -n 1 "$commit_msg_file")"

pattern='^(feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert)(\\([a-z0-9_-]+\\))?(!)?: .+'

if ! printf '%s' "$first_line" | LC_ALL=C grep -Eq "$pattern"; then
  cat <<'EOF'
Invalid commit message format.
Use one of:
  feat: your message
  fix: your message
  docs: your message
  style: your message
  refactor: your message
  perf: your message
  test: your message
  build: your message
  ci: your message
  chore: your message
  revert: your message
Optional scope:
  feat(scope): your message
Optional breaking change:
  feat!: your message
  feat(scope)!: your message
EOF
  exit 1
fi
